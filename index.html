<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Giraffe</title>
	<link rel="canonical" href="https://liutabu.github.io/giraffe/" />
	<link rel="manifest" href="/giraffe/manifest.json">
	<link rel="stylesheet" href="css/style.css">
	<link rel="icon" href="favicon.ico" type="image/x-icon" />
	<link rel="apple-touch-icon" href="images/giraffe-152.png">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
		integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="theme-color" content="white" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-title" content="Giraffe">
	<meta name="msapplication-TileImage" content="images/giraffe-144.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
</head>

<body class="sandy-brown" style="text-align: center;">
	<h1 id="app-title" class="coffee-brown">Giraffe</h1>
	<div id="languages">
		<img id="reverse-icon" src="images/reverse-icon.png" onclick="reverseQuiz()">
		<img class="language" src="images/lithuania-512.png" onclick="setLanguage('lt')">
		<img class="language" src="images/uk-1024.png" onclick="setLanguage('en')">
	</div>
	<div id="card" class="japanese-indigo">
		<div id="content"></div>
		<div id="control"></div>
	</div>
	<script>
		if (navigator.serviceWorker) {
			navigator.serviceWorker.register('/giraffe/sw.js', { scope: '/giraffe/' })
		}
	</script>
	<script src="js/main.js"></script>
</body>

<script>
	const words = [
		{
			"word": "en arm",
			"translation_lt": "ranka",
			"translation_en": "hand"
		},
		{
			"word": "ett öga",
			"translation_lt": "akis",
			"translation_en": "eye"
		},
		{
			"word": "en navel",
			"translation_lt": "bamba",
			"translation_en": "navel"
		},
		{
			"word": "en midja",
			"translation_lt": "juosmuo/liemuo",
			"translation_en": "waist"
		},
		{
			"word": "en häl",
			"translation_lt": "kulnas",
			"translation_en": "heel"
		},
		{
			"word": "en hals",
			"translation_lt": "smakras, gerklė",
			"translation_en": "throat"
		},
		{
			"word": "en nacke",
			"translation_lt": "kaklas",
			"translation_en": "neck"
		},
		{
			"word": "ett knä",
			"translation_lt": "kelis",
			"translation_en": "knee"
		},
		{
			"word": "en vad",
			"translation_lt": "blauzda",
			"translation_en": "calf"
		},
		{
			"word": "en mun",
			"translation_lt": "burna",
			"translation_en": "mouth"
		},
		{
			"word": "ett huvud",
			"translation_lt": "galva",
			"translation_en": "head"
		},
		{
			"word": "en rygg",
			"translation_lt": "nugara",
			"translation_en": "back"
		},
		{
			"word": "en höft",
			"translation_lt": "klubas",
			"translation_en": "hip"
		},
		{
			"word": "en armbåge",
			"translation_lt": "alkūnė",
			"translation_en": "elbow"
		},
		{
			"word": "en hand",
			"translation_lt": "ranka",
			"translation_en": "hand"
		},
		{
			"word": "en fot",
			"translation_lt": "pėda",
			"translation_en": "feet"
		},
		{
			"word": "en näsa",
			"translation_lt": "nosis",
			"translation_en": "nose"
		},
		{
			"word": "ett finger",
			"translation_lt": "pirštas",
			"translation_en": "finger"
		},
		{
			"word": "ett lår",
			"translation_lt": "šlaunis",
			"translation_en": "thigh"
		},
		{
			"word": "en haka",
			"translation_lt": "smakras",
			"translation_en": "chin"
		},
		{
			"word": "en mage",
			"translation_lt": "skrandis",
			"translation_en": "stomach"
		},
		{
			"word": "ett bröst",
			"translation_lt": "krūtinė",
			"translation_en": "breast"
		},
		{
			"word": "ett öra",
			"translation_lt": "ausis",
			"translation_en": "ear"
		},
		{
			"word": "en axel",
			"translation_lt": "petys",
			"translation_en": "shoulder"
		},
		{
			"word": "(ett) hår",
			"translation_lt": "plaukas, plaukai",
			"translation_en": "hair"
		},
		{
			"word": "en kind",
			"translation_lt": "skruostas",
			"translation_en": "cheek"
		},
		{
			"word": "ett ögonbryn",
			"translation_lt": "antakis",
			"translation_en": "eyebrow"
		},
		{
			"word": "en rumpa/en stjärt",
			"translation_lt": "užpakalis",
			"translation_en": "butt"
		}
	];
</script>
<script>
	var index, mistakes, amountOfWrongAnswers, selectedLanguage, answersArray;
	selectedLanguage = '';
	isReverse = false;

	init();

	function init() {
		index = 0;
		mistakes = [];
		amountOfWrongAnswers = 4;

		words.sort(() => 0.5 - Math.random());

		document.getElementById("content").innerHTML = '';

		addItems(words[index]);

		var restart = document.getElementById("restart");
		restart && restart.remove();

		addControls();
	}

	function setLanguage(language) {
		selectedLanguage = language;
		init();
	}

	function reverseQuiz() {
		isReverse = !isReverse;
		
		words.forEach(answer => {
			[answer.word, answer.translation] = [answer.translation, answer.word];
		});
		
		init();
	}

	function switchQuestion(position) {
		if (position === 1 && (index >= 0 && index < words.length - 1) || position === - 1 && (index > 0 && index <= words.length - 1)) {
			index += position;
			document.getElementById("tile").remove();

			addItems(words[index]);
			document.getElementById("count").innerHTML = index + 1 + "/" + words.length;
			return;
		}

		if (index === words.length - 1) {
			document.getElementById("tile").remove();

			showResults();
		}
	}

	function formatAnswers(correctItem) {
		var incorrectAnswers = words.filter(obj => {
			return obj["translation" + selectedLanguage] !== correctItem["translation" + selectedLanguage];
		});

		incorrectAnswers.sort(() => 0.5 - Math.random());

		var randomAnswers = incorrectAnswers.slice(0, amountOfWrongAnswers);
		randomAnswers.push(correctItem);

		return randomAnswers.sort(() => 0.5 - Math.random());
	}

	function makeGuess(element, word, correctAnswer) {
		if (element.value === correctAnswer) {
			element.labels[0].style.color = 'limeGreen';
			return;
		}

		element.labels[0].style.color = '#ee0000';
		!mistakes.some(item => item.guess === element.value) && mistakes.push({ word, guess: element.value, answer: correctAnswer });
	}

	function addItems(item) {
		answersArray = formatAnswers(item);

		document.getElementById("content").insertAdjacentHTML("beforeend", `<div id="tile" class="hansa-yellow"><h1>${item.word}</h1></div>`);

		var tile = document.getElementById("tile");
		answersArray.forEach((answer, i) => {
			tile.insertAdjacentHTML("beforeend", `<div><input type="radio" id="no-${i}" value="${answersArray[i]["translation" + selectedLanguage]}" onclick="makeGuess(this, '${item.word}', '${item["translation" + selectedLanguage]}')"><label for="no-${i}" class="ivory">${answersArray[i]["translation" + selectedLanguage]}</label></div>`);
		});
	}

	function addControls() {
		var control = document.getElementById("control");

		if (control.firstChild) {
			document.getElementById("count").innerHTML = index + 1 + "/" + words.length;
			return;
		}

		control.insertAdjacentHTML("beforeend", '<button id="prev" onclick="switchQuestion(-1)">\<</button>');
		control.insertAdjacentHTML("beforeend", '<button id="next" onclick="switchQuestion(1)">\></button>');
		control.insertAdjacentHTML("beforeend", '<div id="count" class="ivory"></div>');
		document.getElementById("count").innerHTML = index + 1 + "/" + words.length;
	}

	function showResults() {
		var content = document.getElementById("content");
		document.getElementById("control").innerHTML = '<button id="restart" onclick="init()">Restart</button>';

		if (!mistakes.length) {
			content.insertAdjacentHTML("beforeend", '<div class="result-title ivory"><h1>You made no mistakes! Congrats!</h1></br></div>');
			return;
		}

		content.insertAdjacentHTML("beforeend", '<div class="result-title ivory"><h1>Your mistakes:</h1></div>');
		mistakes.forEach(mistake => {
			content.insertAdjacentHTML("beforeend", `<div class="mistakes"><span class="ivory">${mistake.word} - </span><span class="failures">${mistake.guess}</span> <span class="answers">${mistake.answer}</span></div>`);
		});
	}
</script>

</html>